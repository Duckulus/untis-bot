generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DB_URL")
}

model User {
  id                 String        @id @unique @default(uuid())
  createdAt          DateTime      @default(now())
  subscribed         Boolean       @default(true)
  hours              Int           @default(7)
  minutes            Int           @default(0)
  whatsappUser       WhatsappUser? @relation(fields: [whatsappUserNumber], references: [number])
  whatsappUserNumber String?       @unique
  discordUser        DiscordUser?  @relation(fields: [discordUserId], references: [userId])
  discordUserId      String?       @unique
  untis              Untis[]
}

model WhatsappUser {
  number String @id @unique
  user   User?
}

model DiscordUser {
  userId     String @id @unique
  oauthToken String
  user       User?
}

model Untis {
  id             Int    @id @unique @default(autoincrement())
  untis_school   String @default("")
  untis_username String @default("")
  untis_password String @default("")
  untis_eap      String @default("ajax.webuntis.com")
  User           User[]

  @@unique([untis_school, untis_username])
}
